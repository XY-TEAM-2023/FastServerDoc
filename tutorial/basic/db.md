# 数据库

!> 框架目前只支持Mysql，推荐使用5.7版本



## 1. 原生用法

- 拼写sql语句

  ![image-20240217192331744](db.assets/image-20240217192331744.png)

- 动态参数（推荐）

  > 可以防止SQL注入

  ![image-20240217192420831](db.assets/image-20240217192420831.png)

- 调用 `执行SQL语句` 后可调用的命令

  ![image-20240217192710269](db.assets/image-20240217192710269.png)



---



## 2. 数据库映射（推荐）

将数据库中每个表 生成 对应的一个类，数据更直观，操作更方便

### 2.1 生成数据库映射

- 打开 **开发工具**， 选择数据库切页

  ![image-20241125111634686](./db.assets/image-20241125111634686.png)

  ![image-20241125115427443](./db.assets/image-20241125115427443.png)

- 右键——新建连接

  ![image-20241125115453288](./db.assets/image-20241125115453288.png)

- 输入数据库连接信息

  ![image-20241125115559185](./db.assets/image-20241125115559185.png)

- 点击测试连接

  ![image-20241125115613620](./db.assets/image-20241125115613620.png)

- 双击数据库连接

  ![image-20241125115641523](./db.assets/image-20241125115641523.png)

- 设置映射文件生成路径

  ![image-20241125115719378](./db.assets/image-20241125115719378.png)

- 选择项目目录中，数据库——数据库映射结构这个文件

  ![image-20241125115821634](./db.assets/image-20241125115821634.png)

- 点击生成映射

- 打开项目中的 `数据库映射结构` 即可看到生成的映射代码（如果已经打开过，关闭后重新打开）

!> 修改数据库结构、添加表都需要重新生成代码

### 2.2 插入单条

![image-20240217193423994](db.assets/image-20240217193423994.png)

### 2.3 插入多条

![image-20240217193834893](db.assets/image-20240217193834893.png)

### 2.4 查询单条数据

- 根据主键查询

  ![image-20240217194115304](db.assets/image-20240217194115304.png)

- 根据其他字段查询

  ![image-20240217194201947](db.assets/image-20240217194201947.png)

- 查询指定的字段

  ![image-20240217194439087](db.assets/image-20240217194439087.png)

### 2.5 查询多条数据

查询账号状态正常的管理员账号

- 查询所有

  ![image-20241125121535676](./db.assets/image-20241125121535676.png)

- 分页查询

  ![image-20240217195207233](db.assets/image-20240217195207233.png)



### 2.6 修改单条数据

- 先查后改

  ![image-20240217200008247](db.assets/image-20240217200008247.png)

- 不查询，直接修改

  ![image-20240217195601496](db.assets/image-20240217195601496.png)



### 2.7 修改多条数据

> 映射暂未支持该方法，这里为原生写法

![image-20231010154141718](db.assets/image-20231010154141718.png)



### 2.8 删除数据

- 根据主键删除

  ![image-20240217195925585](db.assets/image-20240217195925585.png)

- 根据字段删除

  ![image-20240217200113282](db.assets/image-20240217200113282.png)

- 根据条件筛选删除

  ![image-20240217200254623](db.assets/image-20240217200254623.png)



!> **什么时候用动态参数？**</br>1. sql语句比较复杂，参数较多</br>2. sql查询参数是由前端发送的</br>补充：其他情况下可以不使用动态参数
